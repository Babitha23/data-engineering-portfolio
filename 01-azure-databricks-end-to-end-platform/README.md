# UK Energy Intelligence Lakehouse Platform

An end-to-end Azure-based data engineering platform that ingests, transforms, and models UK government energy datasets using a Lakehouse architecture (Bronze–Silver–Gold) for analytics and reporting.

## Project Overview

This project demonstrates how large, complex public-sector energy datasets can be transformed into analytics-ready data using modern data engineering best practices.

UK government energy datasets are published in Excel and CSV formats with:
- Multiple tables per file
- Inconsistent schemas
- Hierarchical headers
- Monthly, quarterly, and annual reporting structures

The goal of this project is to design and implement a scalable Azure Lakehouse platform that:
- Ingests raw energy datasets
- Cleans and standardises them
- Models them into fact and dimension tables
- Makes them ready for analytics, reporting, and BI consumption

## Business Use Case

Energy policy analysts, regulators, and planners require consistent and reliable data to understand:
- How electricity is generated by fuel type
- How supply and demand components change over time
- Trends in consumption across sectors

However, UK energy data is fragmented across multiple Excel-based statistical releases.

This platform enables:
- Centralised energy data storage
- Consistent metrics across datasets
- Faster policy and operational analysis
- Reliable historical comparisons

The curated Gold layer can directly support:
- Energy mix analysis (renewables vs fossil fuels)
- Supply vs demand balancing
- Long-term energy transition insights

## Architecture Overview

The platform follows a modern Azure Lakehouse architecture:

1. Raw energy datasets are ingested from UK Government sources
2. Azure Data Factory orchestrates ingestion into ADLS Gen2 (Bronze)
3. Azure Databricks performs data cleaning and standardisation (Silver)
4. Curated fact and dimension tables are created in the Gold layer
5. Azure Synapse Serverless enables cost-efficient SQL analytics
6. Power BI can be connected directly to the Gold layer for reporting

## Datasets Used

All datasets are sourced from GOV.UK Energy Trends and official statistics.

| Dataset | Description | Frequency |
|------|------------|----------|
| Historical Electricity Data | Long-term electricity generation trends | Annual |
| ET 5.1 | Electricity generation by fuel type | Monthly |
| ET 5.2 | Electricity supply and demand components | Monthly |
| ET 3.1 | Final energy consumption by sector | Monthly |
| ECUK | UK energy consumption by sector | Annual |

## Data Pipeline & Lakehouse Design

The platform follows a Medallion (Bronze–Silver–Gold) architecture.

### Bronze Layer
- Raw Excel files
- Stored exactly as received
- No transformations applied

### Silver Layer
- Cleaned and standardised datasets
- Normalised column names and data types
- Hierarchical Excel structures flattened
- Validated for data quality

### Gold Layer
- Analytics-ready fact and dimension tables
- Star schema modelling
- Optimised for SQL and BI consumption

## Data Modelling

The Gold layer follows a star schema design.

### Dimensions
- `dim_time`
- `dim_energy_type`
- `dim_sector`
- `dim_region`

### Fact Tables
- `fact_energy_generation`
- `fact_energy_supply_demand`
- `fact_energy_consumption`

This design enables efficient querying and scalable analytics.

## Technologies Used

- Azure Data Factory – ingestion orchestration
- Azure Data Lake Storage Gen2 – data lake storage
- Azure Databricks – data transformation and Delta Lake
- Apache Spark (PySpark)
- Delta Lake
- Azure Synapse Serverless SQL – cost-efficient analytics
- GitHub – version control and portfolio hosting

## Key Engineering Challenges Solved

- Ingesting Excel files with multiple logical tables per sheet
- Handling hierarchical headers and null-based grouping
- Supporting monthly, quarterly, and annual reporting structures
- Designing reusable Spark transformation functions
- Making Databricks notebooks GitHub-friendly for portfolio review

## Repository Structure

```text
01-azure-databricks-end-to-end-platform/
├── config/
│   └── datasets.yml
├── notebooks/
│   ├── 01_bronze_to_silver_energy_trends_et5.1.ipynb
│   ├── 02_bronze_to_silver_energy_trends_et5.2.ipynb
├── docs/
│   ├── Daily_logs/
│   ├── ARCHITECTURE.md
|   ├── DATA_DICTIONARY.md
|   ├── PROJECT_OVERVIEW.md
└── README.md
